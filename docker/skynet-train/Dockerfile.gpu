FROM developmentseed/caffe-segnet:gpu
MAINTAINER anand@developmentseed.org

ENV DEBIAN_FRONTEND noninteractive
RUN curl -sL https://deb.nodesource.com/setup_6.x | sudo -E bash - && \
    sudo apt-get install -y nodejs build-essential

RUN pip install boto3 && \
    pip install protobuf && \
    pip install cython && \
    pip install scikit-image

ADD package.json /workspace/package.json
RUN npm install

ADD . /workspace
WORKDIR /workspace

# Expose demo server port
EXPOSE 5000

ENTRYPOINT ["python", "-u", "segnet/train"]

